plugins {
    id 'fabric-loom' version '0.4-SNAPSHOT'
    id 'maven-publish'
}

group = maven_group
archivesBaseName = mod_id + "-fabric"
version = "${mod_version}+${minecraft_version}"

java {
    sourceCompatibility = JavaVersion.VERSION_1_8
    targetCompatibility = JavaVersion.VERSION_1_8
}

minecraft { accessWidener file("src/main/resources/${mod_id}.accesswidener") }

dependencies {
    minecraft "com.mojang:minecraft:${minecraft_version}"
    mappings "net.fabricmc:yarn:${minecraft_version}+build.${yarn_version}:v2"
    modImplementation "net.fabricmc:fabric-loader:${loader_version}"
}

processResources {
    inputs.properties(
            "mod_id": mod_id,
            "mod_name": mod_name,
            "mod_version": mod_version,
            "minecraft_version": minecraft_version,
            "loader_version": loader_version
    )

    from(sourceSets.main.resources.srcDirs) {
        include 'fabric.mod.json'
        expand(
                'mod_id': mod_id,
                'mod_name': mod_name,
                'mod_version': mod_version,
                'minecraft_version': minecraft_version,
                'loader_version': loader_version
        )
    }

    from(sourceSets.main.resources.srcDirs) { exclude 'fabric.mod.json' }
}

tasks.withType(JavaCompile) { options.encoding = 'UTF-8' }

jar { from('LICENSE') }